---
sonarqube:
  stage: qa
  tags: ["docker"]
  extends: .only-master-mr
  when: manual
  dependencies: [build_mpi,
                 test_seq,test_mpi,test_seq_sched_linux,test_mpi_sched_linux,
                 test_seq_wrapper_linux,test_mpi_wrapper_linux,
                 coverage]
  script:
    - ls -l build/*.json
    - ls -l pastix-build*.log
    - ls -l pastix-test*junit.xml
    - ls -l pastix-coverage.xml
    - ${CI_PROJECT_DIR}/tools/analysis.sh
  artifacts:
    name: "$CI_JOB_NAME-$CI_COMMIT_REF_SLUG"
    expire_in: 180 minutes
    paths:
      - filelist.txt
      - pastix-cppcheck.xml
      - sonar-project.properties
      - sonar.log
    when: always
